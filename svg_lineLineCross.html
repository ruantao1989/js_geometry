<!DOCTYPE html svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<html>
	<head>
		<title>SVG_Test</title>
		<style type="text/css">
			#container{
				position: relative;
				border:"#555 solid 1px";
				width : 500px;
				height:500px;
			}
			#svgContainer {
				position:absolute;
				width : 100%;
				height:100%;
			}
			#svgRuler{
				position:absolute;
				width : 100%;
				height:100%;
			}
		</style>
	</head>
	<body>
		<div id="container">
			
		</div>
	</body>

	<script type="text/javascript" src="util.js"></script>
	<script type="text/javascript" src="svgTool.js"></script>
	<script type="text/javascript" src="geometryTool.js"></script>
	<script type="text/javascript">
		
		//标尺
		createSVGContainer("svgRuler","container");
		createSVGRuler("svgRuler","container");

		//实验折线
		createSVGContainer("svgContainer","container");
		drawLine([{x:30,y:100},{x:150,y:210}],null,"svgContainer");
		drawLine([{x:150,y:150},{x:50,y:250}],null,"svgContainer");
		drawLine([{x:50,y:100},{x:90,y:250},{x:150,y:170}],null,"svgContainer");

		//折线求焦点
		getAllCross("svgContainer");
		function getAllCross(containerId) {
			var svgContainer = $$(containerId);
			var paths = svgContainer.getElementsByTagName("path");
			//遍历匹配
			for (var i = 0, len = paths.length; i < len; i++) {
				var one = paths[i];

				for (var j = i + 1; j < len; j++) {
					var two = paths[j];
					getCrossOfTwoPath(one, two);
				}
			}
		}
		//两折线求焦点
		function getCrossOfTwoPath(one,two){
			var onePath = getPointsArray(one),
				twoPath = getPointsArray(two);

			for( var i=0,len=onePath.length-1;i<len;i++){
				var startPoint1 = onePath[i],
					endPoint1 = onePath[i+1];
				if( !endPoint1 ){
					continue;
				}
				
				for( var j=0,len=twoPath.length-1;j<len;j++){
					var startPoint2 = twoPath[j],
						endPoint2 = twoPath[j+1];
					if( !endPoint2 ){
						continue;
					}
					//遍历path 拿到4个点, 求焦点
					var p = getCrossPoint(startPoint1, endPoint1, startPoint2, endPoint2);
					if (p) {
						pointAmark(p);
					}
				}
			}
			return false;	
		}
	</script>
</html>
